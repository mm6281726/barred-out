<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<script src="processing.js"></script> 
</head>

<canvas id="canvas1" width="1200" height="800"></canvas>

<script type="text/javascript">
var sketch = new Processing.Sketch();

  // this code was autogenerated from PJS
sketch.attachFunction = (function($p) {
    var Cell = (function() {
        function Cell() {
            var $this_1 = this;

            function $superCstr() {
                $p.extendClassChain($this_1)
            }
            $this_1.x = 0;
            $this_1.y = 0;
            $this_1.w = 0;
            $this_1.h = 0;
            $this_1.angle = 0;
            $this_1.rand1 = 0;
            $this_1.rand2 = 0;
            $this_1.rand3 = 0;
            $this_1.position = 0;

            function oscillate$0() {
                $this_1.angle += 0.02;
            }
            $p.addMethod($this_1, 'oscillate', oscillate$0, false);

            function display$0() {
              var sinangle = $p.sin($this_1.angle) * 127;
              $p.stroke(127 + sinangle);
              $p.fill(127 + sinangle);            
              $p.rect($this_1.x, $this_1.y, $this_1.w, $this_1.h);
            }
            $p.addMethod($this_1, 'display', display$0, false);

            function isOuterColumn$0() {
                if ($this_1.position <= 0 || $this_1.position == cols - 1) {
                    return true;
                } else {
                    return false;
                }
            }
            $p.addMethod($this_1, 'isOuterColumn', isOuterColumn$0, false);

            function getOffset$0() {
                if ($this_1.position < cols / 2) {
                    return cols / 2 - $this_1.position;
                } else {
                    return $this_1.position % (cols / 2) + 1;
                }
            }
            $p.addMethod($this_1, 'getOffset', getOffset$0, false);

            function $constr_2(tempX, tempY) {
                $superCstr();

                $this_1.w = $p.width / cols;
                $this_1.h = $p.height / rows;
                $this_1.x = tempX * $this_1.w;
                $this_1.y = tempY * $this_1.h;
                $this_1.position = tempX;
                if (!$this_1.$self.isOuterColumn()) {
                    $this_1.angle = $this_1.position % 2 == 0 ? 2 * $this_1.y : -2 * $this_1.y;
                } else {
                    $this_1.angle = $this_1.position == 0 ? 1 * $p.random(255) : -$this_1.position * $p.random(255);
                }
                $this_1.rand1 = $p.random(255);
                $this_1.rand2 = $p.random(255);
                $this_1.rand3 = $p.random(255);
            }

            function $constr() {
                if (arguments.length === 2) {
                    $constr_2.apply($this_1, arguments);
                } else $superCstr();
            }
            $constr.apply(null, arguments);
        }
        return Cell;
    })();
    $p.Cell = Cell;

    var grid = null;
    var cols = 6;
    var rows = 100;

    function setup() {
        $p.size(window.innerWidth, window.innerHeight);
        $p.background(0);
        grid = $p.createJavaArray('Cell', [cols, rows]);
        for (var i = 0; i < cols; i++) {
            for (var j = 0; j < rows; j++) {
                grid[i][j] = new Cell(i, j);
            }
        }
    }
    $p.setup = setup;
    setup = setup.bind($p);

    function draw() {
        for (var i = 0; i < cols; i++) {
            for (var j = 0; j < rows; j++) {
                grid[i][j].oscillate();
                grid[i][j].display();
            }
        }
    }
    $p.draw = draw;
    draw = draw.bind($p);

    function stop() {
        $super.stop();
    }
    $p.stop = stop;
    stop = stop.bind($p);

    function keyReleased() {
        var divisor = $p.parseFloat(cols) / 20.0;
        if ($p.key == (new $p.Character('r'))) {
            rows++;
            recalibrateGrid();
        } else if ($p.key == (new $p.Character('R'))) {
            rows--;
            recalibrateGrid();
        } else if ($p.key == (new $p.Character('c'))) {
            cols += 2;
            recalibrateGrid();
        } else if ($p.key == (new $p.Character('C'))) {
            cols -= 2;
            recalibrateGrid();
        } else if ($p.key == (new $p.Character('s'))) {
            sensitivity += divisor;
        } else if ($p.key == (new $p.Character('S'))) {
            sensitivity -= divisor;
            if (sensitivity <= 0) {
                sensitivity = 0;
            }
        } else if ($p.key == (new $p.Character('d'))) {
            sensitivityDepth -= divisor;
        } else if ($p.key == (new $p.Character('D'))) {
            sensitivityDepth += divisor;
            if (sensitivityDepth <= 0) {
                sensitivityDepth = 0;
            }
        }
    }
    $p.keyReleased = keyReleased;
    keyReleased = keyReleased.bind($p);

    function recalibrateGrid() {
        grid = $p.createJavaArray('Cell', [cols, rows]);
        for (var i = 0; i < cols; i++) {
            for (var j = 0; j < rows; j++) {
                grid[i][j] = new Cell(i, j);
            }
        }
    }
    $p.recalibrateGrid = recalibrateGrid;
    recalibrateGrid = recalibrateGrid.bind($p);

})

var canvas = document.getElementById("canvas1");
var p = new Processing(canvas, sketch);
</script>

</body>
</html>